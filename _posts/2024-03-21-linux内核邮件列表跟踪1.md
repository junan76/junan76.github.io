---
layout: post
title: linux内核邮件列表跟踪(1)
categories: 邮件列表
tags: linux 邮件列表 八卦
---

最近订阅了两个linux的邮件列表, 可以近距离围观来自世界各地的开发者是如何协同工作的, 相信自己也能学到很多东西. 今天看到了一个开发者提交的补丁, 被另一个开发者稍微喷了一下, 原因是他的`patch`分成了几个部分, 但是发邮件的时候没有组织成`thread`, 导致看代码的人在一堆邮件里找他的邮件浪费了很多时间. 

## 0x01 有问题的补丁

这个补丁是对一个`i2c`设备驱动的修改, 以下是补丁的作者发送的邮件:

![alt text](<../assets/img/posts/2024-03-21-linux内核邮件列表跟踪1/1.png>)

首先, 这个修改比较大, 因此补丁被Edwards分成了5个部分, 并且每封邮件中, 作者比较详细地介绍了自己的修改原因, 解决了什么问题, 这是做的比较好的. 但还是有一些地方不够规范, 比如:

1. 补丁重发了很多次, 这引起了reviewer的一些不满.

2. 补丁的6封邮件没有组织成`thread`, 同样让reviewer不满.

关于第二个问题, 可能因为reviewer在查看代码时, 花了额外的时间在查找邮件上. 对于一个正常的包含多个部分的补丁, 组织成thread的邮件应该是这样的:

![alt text](<../assets/img/posts/2024-03-21-linux内核邮件列表跟踪1/2.png>)

邮件需要进行一些设置, 这样当别人收到补丁的时候, 邮件客户端才会把和这个补丁关联的多个邮件显示成一个`会话`的形式. 这样做能够给补丁作者以及review代码的开发者, 带来很大的方便.

1. 不必在大量邮件中查找你的补丁邮件
2. 方便对补丁的每个部分进行回复
3. 其他人能够从邮件列表中清楚地看到问题的讨论过程

比如像下面这样, 问题的前因后果一目了然:

![alt text](<../assets/img/posts/2024-03-21-linux内核邮件列表跟踪1/3.png>)

试想一下, 如果那个不规范的补丁在发送时, 中间还有很多其他人发送的邮件, reviewer想在邮件列表中找到完整的补丁, 还是要花上一些时间的. 可能你觉得一封邮件而已, 没什么大不了的, 但linux这样庞大的开源项目, 在全球各地的开发者协同工作, 必须要有一些大家必须遵守的行为规范, 否则只能是一团乱麻. 不要因为自己的问题, 给其他开发者带来困扰.

## 0x02 reviewer的回复

其实reviewer的还是很耐心的, 他首先说了一下补丁的代码:

![alt text](<../assets/img/posts/2024-03-21-linux内核邮件列表跟踪1/4.png>)

因为这个补丁发了3次, 他对哪个应该丢弃有点疑问. 可以看到, 补丁作者解释了一下`RESEND`的原因, 他的邮件客户端把空白的行自动删除了, 导致发送的补丁存在问题. 所以, 发送补丁邮件之前还是要配置好自己的工具, 使用`Plain-text`模式.

后面reviewer又提到了邮件`thread`的问题, 并且在回复中告诉补丁作者, 如何设置邮件的`headers`, 才能让发送的邮件组织成`thread`:

![alt text](<../assets/img/posts/2024-03-21-linux内核邮件列表跟踪1/5.png>)

这里Andi说, 要确保邮件1至5的`headers`中, 包含`In-Reply-To`这个字段, 并且把值设置成邮件0的`Message-ID`.

这也是我之前不清楚的一点, 因此特定了解了一下邮件的`headers`中各个字段的功能. 最后, 在thunderbird这个邮件客户端上自己配置也成功了, 收到的多个邮件的确会被组织成`thread`. 这里除了可以设置`In-Reply-To`, 也可以设置`References`, 效果是相同的.

关于邮件的`headers`, 感兴趣的可以参考[这篇文章](https://mailtrap.io/blog/email-headers/), 完整的列表可以参考iana组织的[官方网站](https://mailtrap.io/blog/email-headers/). 这里值得注意的一点是, 大多数的邮件客户端, 都不会让你随意修改`headers`, 因此, 你要对自己的邮件客户端做一点研究, 才可以编辑`headers`.

## 0x03 总结

1. 要参与一个开源项目, 需要遵守这个项目的一些行为规范, 不给被人带来麻烦;

2. 内核开发人员还是比较有耐心的;

3. 在邮件列表中, 除了代码, 也可以了解到其他和技术相关的东西;

原始邮件内容, [参考这里](https://lore.kernel.org/linux-i2c/p37qqpplxgmfzlq6wz7fvmvnrsumy6ra5nivzi4hd2gbvlbezx@dlh6ygyjbk24/).